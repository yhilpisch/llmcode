<img src="https://theaiengineer.dev/tae_logo_gw_flatter.png" width=35% align=right>

# Building a Large Language Model from Scratch - Book Companion Code

This repository contains the executable code assets that accompany the book:

Building a Large Language Model from Scratch — A Step‑by‑Step Guide Using Python and PyTorch

It is designed as a hands‑on companion: pair the book manuscript with this repo to run the same scripts and notebooks locally, inspect results, and extend the examples.

## What’s Inside

- `code/` — Python modules and scripts per chapter, plus small utilities.
- `notebooks/` — Jupyter notebooks that mirror the book’s walkthroughs.
- `figures/` — Static figures generated by the code (used in the book).
- `tools/` — Validation helpers to run scripts/notebooks in batch.
- `requirements.txt` — Minimal packages used across chapters.

The project keeps dependencies intentionally light. Install PyTorch separately following the official instructions for your platform.

## Setup: Local Virtual Environment

Below are reliable, copy‑pasteable steps to get a clean `.venv` and install requirements.

Unix/macOS (bash/zsh)

```
python3 -m venv .venv
source .venv/bin/activate
python -m pip install --upgrade pip wheel
pip install -r requirements.txt

# Install PyTorch for your platform (examples):
# CPU only:
#   pip install --index-url https://download.pytorch.org/whl/cpu torch torchvision torchaudio
# Apple Silicon (MPS):
#   pip install torch torchvision torchaudio
# CUDA (choose the right CUDA version from pytorch.org):
#   pip install --index-url https://download.pytorch.org/whl/cu121 torch torchvision torchaudio

# Helpful links:
#   Apple Silicon (MPS) guide: https://pytorch.org/get-started/locally/ (select macOS + pip + MPS)
#   CUDA wheels index (e.g., cu121): https://download.pytorch.org/whl/cu121
#   CPU wheels index: https://download.pytorch.org/whl/cpu

# Optional: for notebook execution helper
pip install nbclient nbformat
```

Windows (PowerShell)

```
py -m venv .venv
.\.venv\Scripts\Activate.ps1
python -m pip install --upgrade pip wheel
pip install -r requirements.txt

# Install PyTorch from https://pytorch.org/get-started/locally/
# Example (CPU only):
#   pip install --index-url https://download.pytorch.org/whl/cpu torch torchvision torchaudio

# Helpful links:
#   Apple Silicon (MPS) guide: https://pytorch.org/get-started/locally/ (select macOS + pip + MPS)
#   CUDA wheels index (e.g., cu121): https://download.pytorch.org/whl/cu121
#   CPU wheels index: https://download.pytorch.org/whl/cpu

# Optional: for notebook execution helper
pip install nbclient nbformat
```

## Python Version

- Recommended: Python 3.11. This repo is tested with 3.11 and avoids edge cases seen with newer versions.
- If you encounter errors like: `AttributeError: module 'code' has no attribute 'InteractiveConsole'` (often on Python 3.13), use Python 3.11 for now. The project’s `code/` package name can shadow the stdlib module named `code` under some setups.

Quick ways to create a 3.11 venv

- macOS (Homebrew):

```
brew install python@3.11
/opt/homebrew/bin/python3.11 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

- pyenv:

```
pyenv install 3.11.9
~/.pyenv/versions/3.11.9/bin/python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Validating Everything Runs

- Validate all Python scripts under `code/`:

```
python tools/validate_scripts.py
```

- Validate all notebooks under `notebooks/` (executes each notebook):

```
python tools/validate_notebooks.py
# or force a specific kernel
python tools/validate_notebooks.py --kernel python3
```

Both validators print structured, timed output for Structure / Imports / Execute and end with a summary like:

```
[25/26] Validating notebooks/ch25_reproducible_research_playbook.ipynb
  • Structure: OK   (1.3ms)
  • Imports: OK   (1.6ms scan, 0.0ms probe)
  • Execute: OK   (1.06s)
  • Total: 1.07s
```

## Requirements

The minimal shared requirements are captured in `requirements.txt`:

```
numpy>=1.24
tqdm>=4.66
tensorboard>=2.13
graphviz>=0.20
typing-extensions>=4.8

# IMPORTANT: Install PyTorch following instructions for your OS/GPU:
# https://pytorch.org/get-started/locally/
```

Some chapters may suggest optional extras (e.g., `fastapi`, `streamlit`) in the code comments; install those ad‑hoc when exploring those parts.

## Tips

- Keep edit→run loops tight by working in a small terminal + editor split and running individual scripts first, then notebooks.
- Use `code/env_check.py` and `code/check_backends.py` to confirm your Python/torch environment.
- If notebook execution is slow, start with scripts to validate logic, then run the notebook cell‑by‑cell.

## Disclaimer

This repository is provided "as is" for educational purposes. No warranties, guarantees, or representations of any kind are made regarding correctness, completeness, fitness for a particular purpose, or non‑infringement. Code and examples are intended for illustration and learning; they may omit production concerns (error handling, security, performance, robustness). Use at your own risk. Dependencies evolve over time; version changes can affect behavior or break examples.

## Credits and License

Scripts © Dr. Yves J. Hilpisch with GPT‑5. All rights reserved unless otherwise noted. See source files for per‑file notices where applicable.

This repository is a companion to the book “Building a Large Language Model from Scratch — A Step‑by‑Step Guide Using Python and PyTorch”.

<img src="https://theaiengineer.dev/tae_logo_gw_flatter.png" width=35% align=right>
